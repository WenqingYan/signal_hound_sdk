<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SM API: I/Q Streaming (VRT)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="sh-logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">SM API
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">I/Q Streaming (VRT) </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md57">Examples</a><ul><li class="level2"><a href="#autotoc_md58">Parsing Example</a></li>
<li class="level2"><a href="#autotoc_md59">GUI Example</a></li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md60">Basics</a><ul><li class="level2"><a href="#autotoc_md61">Type and Function of Packets</a><ul><li class="level3"><a href="#autotoc_md62">Signal Data Packets</a></li>
<li class="level3"><a href="#autotoc_md63">Context Packets</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#autotoc_md64">Specification</a></li>
</ul>
</div>
<div class="textblock"><p ><a class="anchor" id="md_C__Users_Roger_Documents_Dev_Checkout_SM_API_docs_page_iq_vrt"></a></p>
<p >The API provides the ability to stream I/Q samples contained in data packets that conform to the ANSI/VITA 49 Radio Transport (VRT) standard.</p>
<h1><a class="anchor" id="autotoc_md57"></a>
Examples</h1>
<p >For a list of all examples, please see the <em>examples/cpp/vita49</em> folder in the SDK.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> *  Get a VRT Context packet from a Signal Hound SM Series device followed by a block of 1000 Signal Data packets</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="sm__api_8h.html">sm_api.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="sm__api__vrt_8h.html">sm_api_vrt.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#pragma comment(lib, &quot;sm_api&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> getVRTPackets() {</div>
<div class="line">    <span class="comment">// Set up device</span></div>
<div class="line">    <span class="keywordtype">int</span> device = -1;</div>
<div class="line">    <span class="comment">//SmStatus status = smOpenDevice(&amp;device); // USB</span></div>
<div class="line">    <a class="code hl_enumeration" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481">SmStatus</a> status = <a class="code hl_function" href="sm__api_8h.html#a5ba7f9d9e9f280f1e8bd66ab59f35383">smOpenNetworkedDevice</a>(&amp;device, <a class="code hl_define" href="sm__api_8h.html#afd9acb67d1d2e60e2ef2ada153ef612e">SM_ADDR_ANY</a>, <a class="code hl_define" href="sm__api_8h.html#a45e07800f6496c628ff4d5566d66e030">SM_DEFAULT_ADDR</a>, <a class="code hl_define" href="sm__api_8h.html#a386ddda1dbf1b1de58a252430ff382fd">SM_DEFAULT_PORT</a>); <span class="comment">// Networked</span></div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a>) {</div>
<div class="line">        <span class="comment">// Could not open Sm Series device</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set IQ parameters</span></div>
<div class="line">    <a class="code hl_function" href="sm__api_8h.html#a0893bdca6ed868affd6f1f572a39b0e1">smSetIQCenterFreq</a>(device, 3.0e9);</div>
<div class="line">    <a class="code hl_function" href="sm__api_8h.html#a91c88cc0e0660bb7754dcf3e442d04b1">smSetIQSampleRate</a>(device, 2);</div>
<div class="line">    <a class="code hl_function" href="sm__api_8h.html#a4de2871d9c2a7048099fa2f18990ab9e">smSetIQBandwidth</a>(device, <a class="code hl_enumvalue" href="sm__api_8h.html#a7bc7e094191bf3da1431e2ccbd305678a6c87b99087d3d026623b584827e0513a">smTrue</a>, 20.0e6);</div>
<div class="line">    <a class="code hl_function" href="sm__api_8h.html#a9bedf092587ad08783672b8e455601a4">smSetRefLevel</a>(device, -20);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set VRt parameters</span></div>
<div class="line">    <a class="code hl_function" href="sm__api__vrt_8h.html#a00037c6c36c056d57439af5ab633080c">smSetVrtStreamID</a>(device, 1);</div>
<div class="line">    <a class="code hl_function" href="sm__api__vrt_8h.html#a37d53b0ed51f9324e6cec39616c1ab34">smSetVrtPacketSize</a>(device, 16384);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Configure</span></div>
<div class="line">    status = <a class="code hl_function" href="sm__api_8h.html#acf23fbdb5fe507b013d908a2eadff769">smConfigure</a>(device, <a class="code hl_enumvalue" href="sm__api_8h.html#a8ffdfc5be745a55877acb97cf907064aa753d26df914a7119cda8d3b9a002dd7d">smModeIQStreaming</a>); <span class="comment">// VRT mode</span></div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a>) {</div>
<div class="line">        <span class="comment">// Could not configure SM Series device</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Allocate memory</span></div>
<div class="line">    uint32_t contextWordCount;</div>
<div class="line">    status = <a class="code hl_function" href="sm__api__vrt_8h.html#ace4fc4a9691427e0e7779df21ee6d753">smGetVrtContextPktSize</a>(device, &amp;contextWordCount);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a>) {</div>
<div class="line">        <span class="comment">// Could not get context packet size</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> dataPacketCount = 1000;</div>
<div class="line"> </div>
<div class="line">    uint16_t samplesPerPkt;</div>
<div class="line">    uint32_t dataWordCount;</div>
<div class="line">    status = <a class="code hl_function" href="sm__api__vrt_8h.html#a974a6ffc8d9870a28569551060fd3b57">smGetVrtPacketSize</a>(device, &amp;samplesPerPkt, &amp;dataWordCount);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a>) {</div>
<div class="line">        <span class="comment">// Could not get data packet size and word count</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    uint32_t wordCount = contextWordCount + dataWordCount * dataPacketCount;</div>
<div class="line">    uint32_t *words = <span class="keyword">new</span> uint32_t[wordCount];</div>
<div class="line">    uint32_t *curr = words;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get context packet</span></div>
<div class="line">    uint32_t actualContextWordCount;</div>
<div class="line">    status = <a class="code hl_function" href="sm__api__vrt_8h.html#acb35cca1105778c8a3b57fb412d38646">smGetVrtContextPkt</a>(device, curr, &amp;actualContextWordCount);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a>) {</div>
<div class="line">        <span class="comment">// Could not get context packet</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(actualContextWordCount != contextWordCount) {</div>
<div class="line">        <span class="comment">// Context packet is not the expected size</span></div>
<div class="line">    }</div>
<div class="line">    curr += contextWordCount;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get data packets</span></div>
<div class="line">    uint32_t actualDataWordCount;</div>
<div class="line">    status = <a class="code hl_function" href="sm__api__vrt_8h.html#a8505ccaca24db5577b11c1fd481583a2">smGetVrtPackets</a>(device, curr, &amp;actualDataWordCount, dataPacketCount, <a class="code hl_enumvalue" href="sm__api_8h.html#a7bc7e094191bf3da1431e2ccbd305678a182711e4aa910f79fe08e3617d63293f">smFalse</a>);</div>
<div class="line">    <span class="keywordflow">if</span>(status != <a class="code hl_enumvalue" href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a>) {</div>
<div class="line">        <span class="comment">// Could not get data packets</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span>(actualDataWordCount != dataWordCount * dataPacketCount) {</div>
<div class="line">        <span class="comment">// Block of data packets is not the expected size</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="sm__api_8h.html#ab6f7b35d6d886375993e774fdb7dc7a2">smCloseDevice</a>(device);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span>(words) <span class="keyword">delete</span>[] words;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="ttc" id="asm__api_8h_html"><div class="ttname"><a href="sm__api_8h.html">sm_api.h</a></div><div class="ttdoc">API functions for the SM435/SM200 spectrum analyzers.</div></div>
<div class="ttc" id="asm__api_8h_html_a0893bdca6ed868affd6f1f572a39b0e1"><div class="ttname"><a href="sm__api_8h.html#a0893bdca6ed868affd6f1f572a39b0e1">smSetIQCenterFreq</a></div><div class="ttdeci">SM_API SmStatus smSetIQCenterFreq(int device, double centerFreqHz)</div></div>
<div class="ttc" id="asm__api_8h_html_a386ddda1dbf1b1de58a252430ff382fd"><div class="ttname"><a href="sm__api_8h.html#a386ddda1dbf1b1de58a252430ff382fd">SM_DEFAULT_PORT</a></div><div class="ttdeci">#define SM_DEFAULT_PORT</div><div class="ttdef"><b>Definition:</b> sm_api.h:64</div></div>
<div class="ttc" id="asm__api_8h_html_a45e07800f6496c628ff4d5566d66e030"><div class="ttname"><a href="sm__api_8h.html#a45e07800f6496c628ff4d5566d66e030">SM_DEFAULT_ADDR</a></div><div class="ttdeci">#define SM_DEFAULT_ADDR</div><div class="ttdef"><b>Definition:</b> sm_api.h:62</div></div>
<div class="ttc" id="asm__api_8h_html_a4de2871d9c2a7048099fa2f18990ab9e"><div class="ttname"><a href="sm__api_8h.html#a4de2871d9c2a7048099fa2f18990ab9e">smSetIQBandwidth</a></div><div class="ttdeci">SM_API SmStatus smSetIQBandwidth(int device, SmBool enableSoftwareFilter, double bandwidth)</div></div>
<div class="ttc" id="asm__api_8h_html_a5ba7f9d9e9f280f1e8bd66ab59f35383"><div class="ttname"><a href="sm__api_8h.html#a5ba7f9d9e9f280f1e8bd66ab59f35383">smOpenNetworkedDevice</a></div><div class="ttdeci">SM_API SmStatus smOpenNetworkedDevice(int *device, const char *hostAddr, const char *deviceAddr, uint16_t port)</div></div>
<div class="ttc" id="asm__api_8h_html_a7bc7e094191bf3da1431e2ccbd305678a182711e4aa910f79fe08e3617d63293f"><div class="ttname"><a href="sm__api_8h.html#a7bc7e094191bf3da1431e2ccbd305678a182711e4aa910f79fe08e3617d63293f">smFalse</a></div><div class="ttdeci">@ smFalse</div><div class="ttdef"><b>Definition:</b> sm_api.h:378</div></div>
<div class="ttc" id="asm__api_8h_html_a7bc7e094191bf3da1431e2ccbd305678a6c87b99087d3d026623b584827e0513a"><div class="ttname"><a href="sm__api_8h.html#a7bc7e094191bf3da1431e2ccbd305678a6c87b99087d3d026623b584827e0513a">smTrue</a></div><div class="ttdeci">@ smTrue</div><div class="ttdef"><b>Definition:</b> sm_api.h:380</div></div>
<div class="ttc" id="asm__api_8h_html_a8ffdfc5be745a55877acb97cf907064aa753d26df914a7119cda8d3b9a002dd7d"><div class="ttname"><a href="sm__api_8h.html#a8ffdfc5be745a55877acb97cf907064aa753d26df914a7119cda8d3b9a002dd7d">smModeIQStreaming</a></div><div class="ttdeci">@ smModeIQStreaming</div><div class="ttdef"><b>Definition:</b> sm_api.h:250</div></div>
<div class="ttc" id="asm__api_8h_html_a91c88cc0e0660bb7754dcf3e442d04b1"><div class="ttname"><a href="sm__api_8h.html#a91c88cc0e0660bb7754dcf3e442d04b1">smSetIQSampleRate</a></div><div class="ttdeci">SM_API SmStatus smSetIQSampleRate(int device, int decimation)</div></div>
<div class="ttc" id="asm__api_8h_html_a9bedf092587ad08783672b8e455601a4"><div class="ttname"><a href="sm__api_8h.html#a9bedf092587ad08783672b8e455601a4">smSetRefLevel</a></div><div class="ttdeci">SM_API SmStatus smSetRefLevel(int device, double refLevel)</div></div>
<div class="ttc" id="asm__api_8h_html_ab6f7b35d6d886375993e774fdb7dc7a2"><div class="ttname"><a href="sm__api_8h.html#ab6f7b35d6d886375993e774fdb7dc7a2">smCloseDevice</a></div><div class="ttdeci">SM_API SmStatus smCloseDevice(int device)</div></div>
<div class="ttc" id="asm__api_8h_html_acf23fbdb5fe507b013d908a2eadff769"><div class="ttname"><a href="sm__api_8h.html#acf23fbdb5fe507b013d908a2eadff769">smConfigure</a></div><div class="ttdeci">SM_API SmStatus smConfigure(int device, SmMode mode)</div></div>
<div class="ttc" id="asm__api_8h_html_ae9134082ecd9b22280319f3034a66481"><div class="ttname"><a href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481">SmStatus</a></div><div class="ttdeci">SmStatus</div><div class="ttdef"><b>Definition:</b> sm_api.h:142</div></div>
<div class="ttc" id="asm__api_8h_html_ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7"><div class="ttname"><a href="sm__api_8h.html#ae9134082ecd9b22280319f3034a66481a6b0f736112895de9e5b2f712505f38f7">smNoError</a></div><div class="ttdeci">@ smNoError</div><div class="ttdef"><b>Definition:</b> sm_api.h:203</div></div>
<div class="ttc" id="asm__api_8h_html_afd9acb67d1d2e60e2ef2ada153ef612e"><div class="ttname"><a href="sm__api_8h.html#afd9acb67d1d2e60e2ef2ada153ef612e">SM_ADDR_ANY</a></div><div class="ttdeci">#define SM_ADDR_ANY</div><div class="ttdef"><b>Definition:</b> sm_api.h:60</div></div>
<div class="ttc" id="asm__api__vrt_8h_html"><div class="ttname"><a href="sm__api__vrt_8h.html">sm_api_vrt.h</a></div><div class="ttdoc">VITA 49 interface.</div></div>
<div class="ttc" id="asm__api__vrt_8h_html_a00037c6c36c056d57439af5ab633080c"><div class="ttname"><a href="sm__api__vrt_8h.html#a00037c6c36c056d57439af5ab633080c">smSetVrtStreamID</a></div><div class="ttdeci">SM_API SmStatus smSetVrtStreamID(int device, uint32_t sid)</div></div>
<div class="ttc" id="asm__api__vrt_8h_html_a37d53b0ed51f9324e6cec39616c1ab34"><div class="ttname"><a href="sm__api__vrt_8h.html#a37d53b0ed51f9324e6cec39616c1ab34">smSetVrtPacketSize</a></div><div class="ttdeci">SM_API SmStatus smSetVrtPacketSize(int device, uint16_t samplesPerPkt)</div></div>
<div class="ttc" id="asm__api__vrt_8h_html_a8505ccaca24db5577b11c1fd481583a2"><div class="ttname"><a href="sm__api__vrt_8h.html#a8505ccaca24db5577b11c1fd481583a2">smGetVrtPackets</a></div><div class="ttdeci">SM_API SmStatus smGetVrtPackets(int device, uint32_t *words, uint32_t *wordCount, uint32_t packetCount, SmBool purgeBeforeAcquire)</div></div>
<div class="ttc" id="asm__api__vrt_8h_html_a974a6ffc8d9870a28569551060fd3b57"><div class="ttname"><a href="sm__api__vrt_8h.html#a974a6ffc8d9870a28569551060fd3b57">smGetVrtPacketSize</a></div><div class="ttdeci">SM_API SmStatus smGetVrtPacketSize(int device, uint16_t *samplesPerPkt, uint32_t *wordCount)</div></div>
<div class="ttc" id="asm__api__vrt_8h_html_acb35cca1105778c8a3b57fb412d38646"><div class="ttname"><a href="sm__api__vrt_8h.html#acb35cca1105778c8a3b57fb412d38646">smGetVrtContextPkt</a></div><div class="ttdeci">SM_API SmStatus smGetVrtContextPkt(int device, uint32_t *words, uint32_t *wordCount)</div></div>
<div class="ttc" id="asm__api__vrt_8h_html_ace4fc4a9691427e0e7779df21ee6d753"><div class="ttname"><a href="sm__api__vrt_8h.html#ace4fc4a9691427e0e7779df21ee6d753">smGetVrtContextPktSize</a></div><div class="ttdeci">SM_API SmStatus smGetVrtContextPktSize(int device, uint32_t *wordCount)</div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md58"></a>
Parsing Example</h2>
<p >The parsing example demonstrates how to ingest VRT packets. The code can be used directly in projects that wish to use the VRT functionality.</p>
<p >It is located in <em>examples/cpp/vita49/gui</em>.</p>
<h2><a class="anchor" id="autotoc_md59"></a>
GUI Example</h2>
<p >The GUI application provides a user-friendly graphical interface to easily experiment with the VRT functionality.</p>
<p >It is located in <em>examples/cpp/vita49/gui</em>, and uses the <a href="https://www.qt.io/">Qt library</a>.</p>
<h1><a class="anchor" id="autotoc_md60"></a>
Basics</h1>
<p >VRT is an open radio transport protocol used to transmit and receive sample data between devices. It is defined by the VITA 49 standard. Signal Hound uses the latest version of the standard, 49.2 (2017).</p>
<p >At a high level, blocks of I/Q samples and information about the receiver's state are wrapped/embedded in packets with standard formats.</p>
<h2><a class="anchor" id="autotoc_md61"></a>
Type and Function of Packets</h2>
<p >VRT uses Signal Data packets and Context packets. Both types contain headers with metadata which includes a Stream Identifier and timestamp.</p>
<h3><a class="anchor" id="autotoc_md62"></a>
Signal Data Packets</h3>
<p >Signal Data packets encapsulate variable-sized blocks of IQ data, along with a 32-bit trailer to convey additional critical information about the state of the receiver at the time the samples were obtained. For example, if the system was being overdriven this would be reported by an indicator in the trailer.</p>
<h3><a class="anchor" id="autotoc_md63"></a>
Context Packets</h3>
<p >Context packets contain information about the receiver’s settings. They are of variable size, depending on how many of the possible ~25 fields are used. Which fields are used is communicated by the Context Indicator field, a 32-bit value which precedes the context fields. Signal Hound uses 10 of the possible context fields.</p>
<h1><a class="anchor" id="autotoc_md64"></a>
Specification</h1>
<p >For a full, precise specification, please see the VRT Manual in the SDK. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4
</small></address>
</body>
</html>
